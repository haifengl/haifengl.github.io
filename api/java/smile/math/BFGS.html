<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_241) on Sun Aug 16 20:25:29 EDT 2020 -->
<title>BFGS</title>
<meta name="date" content="2020-08-16">
<link rel="stylesheet" type="text/css" href="../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="BFGS";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":17,"i1":17,"i2":17};
var tabs = {65535:["t0","All Methods"],1:["t1","Static Methods"],16:["t5","Default Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../index-all.html">Index</a></li>
<li><a href="../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../smile/math/AbstractDifferentiableMultivariateFunction.html" title="class in smile.math"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../smile/math/Complex.html" title="class in smile.math"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../index.html?smile/math/BFGS.html" target="_top">Frames</a></li>
<li><a href="BFGS.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">smile.math</div>
<h2 title="Interface BFGS" class="title">Interface BFGS</h2>
</div>
<div class="contentContainer">
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public interface <span class="typeNameLabel">BFGS</span></pre>
<div class="block">The Broyden–Fletcher–Goldfarb–Shanno (BFGS) algorithm is an iterative
 method for solving unconstrained nonlinear optimization problems.
 <p>
 The BFGS method belongs to quasi-Newton methods, a class of hill-climbing
 optimization techniques that seek a stationary point of a (preferably
 twice continuously differentiable) function. For such problems,
 a necessary condition for optimality is that the gradient be zero.
 Newton's method and the BFGS methods are not guaranteed to converge
 unless the function has a quadratic Taylor expansion near an optimum.
 However, BFGS has proven to have good performance even for non-smooth
 optimizations.
 <p>
 In quasi-Newton methods, the Hessian matrix of second derivatives is
 not computed. Instead, the Hessian matrix is approximated using
 updates specified by gradient evaluations (or approximate gradient
 evaluations). Quasi-Newton methods are generalizations of the secant
 method to find the root of the first derivative for multidimensional
 problems. In multi-dimensional problems, the secant equation does not
 specify a unique solution, and quasi-Newton methods differ in how they
 constrain the solution. The BFGS method is one of the most popular
 members of this class.
 <p>
 Like the original BFGS, the limited-memory BFGS (L-BFGS) uses an
 estimation to the inverse Hessian matrix to steer its search
 through variable space, but where BFGS stores a dense <code>n × n</code>
 approximation to the inverse Hessian (<code>n</code> being the number of
 variables in the problem), L-BFGS stores only a few vectors
 that represent the approximation implicitly. Due to its resulting
 linear memory requirement, the L-BFGS method is particularly well
 suited for optimization problems with a large number of variables
 (e.g., &gt; 1000). Instead of the inverse Hessian <code>H_k</code>, L-BFGS
 maintains * a history of the past <code>m</code> updates of the position
 <code>x</code> and gradient <code>∇f(x)</code>, where generally the
 history size <code>m</code> can be small (often <code>m &lt; 10</code>).
 These updates are used to implicitly do operations requiring the
 <code>H_k</code>-vector product.

 <h2>References</h2>
 <ol>
 <li>D. Liu and J. Nocedal. On the limited memory BFGS method for large scale optimization. Mathematical Programming B 45 (1989) 503-528.</li>
 </ol></div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static org.slf4j.Logger</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../smile/math/BFGS.html#logger">logger</a></span></code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t1" class="tableTab"><span><a href="javascript:show(1);">Static Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t5" class="tableTab"><span><a href="javascript:show(16);">Default Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>static double</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../smile/math/BFGS.html#linesearch-smile.math.MultivariateFunction-double:A-double-double:A-double:A-double:A-double-">linesearch</a></span>(<a href="../../smile/math/MultivariateFunction.html" title="interface in smile.math">MultivariateFunction</a>&nbsp;func,
          double[]&nbsp;xold,
          double&nbsp;fold,
          double[]&nbsp;g,
          double[]&nbsp;p,
          double[]&nbsp;x,
          double&nbsp;stpmax)</code>
<div class="block">Minimize a function along a search direction by find a step which satisfies
 a sufficient decrease condition and a curvature condition.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>static double</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../smile/math/BFGS.html#minimize-smile.math.DifferentiableMultivariateFunction-double:A-double-int-">minimize</a></span>(<a href="../../smile/math/DifferentiableMultivariateFunction.html" title="interface in smile.math">DifferentiableMultivariateFunction</a>&nbsp;func,
        double[]&nbsp;x,
        double&nbsp;gtol,
        int&nbsp;maxIter)</code>
<div class="block">This method solves the unconstrained minimization problem</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>static double</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../smile/math/BFGS.html#minimize-smile.math.DifferentiableMultivariateFunction-int-double:A-double-int-">minimize</a></span>(<a href="../../smile/math/DifferentiableMultivariateFunction.html" title="interface in smile.math">DifferentiableMultivariateFunction</a>&nbsp;func,
        int&nbsp;m,
        double[]&nbsp;x,
        double&nbsp;gtol,
        int&nbsp;maxIter)</code>
<div class="block">This method solves the unconstrained minimization problem</div>
</td>
</tr>
</table>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="logger">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>logger</h4>
<pre>static final&nbsp;org.slf4j.Logger logger</pre>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="minimize-smile.math.DifferentiableMultivariateFunction-int-double:A-double-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>minimize</h4>
<pre>static&nbsp;double&nbsp;minimize(<a href="../../smile/math/DifferentiableMultivariateFunction.html" title="interface in smile.math">DifferentiableMultivariateFunction</a>&nbsp;func,
                       int&nbsp;m,
                       double[]&nbsp;x,
                       double&nbsp;gtol,
                       int&nbsp;maxIter)</pre>
<div class="block">This method solves the unconstrained minimization problem
 <p>
 <pre>
     min f(x),    x = (x1,x2,...,x_n),
 </pre>
 using the limited-memory BFGS method. The method is especially
 effective on problems involving a large number of variables. In
 a typical iteration of this method an approximation <code>Hk</code> to the
 inverse of the Hessian is obtained by applying <code>m</code> BFGS updates to
 a diagonal matrix <code>Hk0</code>, using information from the previous M steps.
 The user specifies the number <code>m</code>, which determines the amount of
 storage required by the routine.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>func</code> - the function to be minimized.</dd>
<dd><code>m</code> - the number of corrections used in the L-BFGS update.
          Values of <code>m</code> less than 3 are not recommended;
          large values of <code>m</code> will result in excessive
          computing time. <code>3 &lt;= m &lt;= 7</code> is recommended.
          A common choice for m is m = 5.</dd>
<dd><code>x</code> - on initial entry this must be set by the user to the values
          of the initial estimate of the solution vector. On exit with
          <code>iflag = 0</code>, it contains the values of the variables
          at the best point found (usually a solution).</dd>
<dd><code>gtol</code> - the convergence tolerance on zeroing the gradient.</dd>
<dd><code>maxIter</code> - the maximum number of iterations.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the minimum value of the function.</dd>
</dl>
</li>
</ul>
<a name="minimize-smile.math.DifferentiableMultivariateFunction-double:A-double-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>minimize</h4>
<pre>static&nbsp;double&nbsp;minimize(<a href="../../smile/math/DifferentiableMultivariateFunction.html" title="interface in smile.math">DifferentiableMultivariateFunction</a>&nbsp;func,
                       double[]&nbsp;x,
                       double&nbsp;gtol,
                       int&nbsp;maxIter)</pre>
<div class="block">This method solves the unconstrained minimization problem
 <p>
 <pre>
     min f(x),    x = (x1,x2,...,x_n),
 </pre>
 using the BFGS method.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>func</code> - the function to be minimized.</dd>
<dd><code>x</code> - on initial entry this must be set by the user to the values
          of the initial estimate of the solution vector. On exit, it
          contains the values of the variables at the best point found
          (usually a solution).</dd>
<dd><code>gtol</code> - the convergence tolerance on zeroing the gradient.</dd>
<dd><code>maxIter</code> - the maximum number of iterations.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the minimum value of the function.</dd>
</dl>
</li>
</ul>
<a name="linesearch-smile.math.MultivariateFunction-double:A-double-double:A-double:A-double:A-double-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>linesearch</h4>
<pre>static&nbsp;double&nbsp;linesearch(<a href="../../smile/math/MultivariateFunction.html" title="interface in smile.math">MultivariateFunction</a>&nbsp;func,
                         double[]&nbsp;xold,
                         double&nbsp;fold,
                         double[]&nbsp;g,
                         double[]&nbsp;p,
                         double[]&nbsp;x,
                         double&nbsp;stpmax)</pre>
<div class="block">Minimize a function along a search direction by find a step which satisfies
 a sufficient decrease condition and a curvature condition.
 <p>
 At each stage this function updates an interval of uncertainty with
 endpoints <code>stx</code> and <code>sty</code>. The interval of
 uncertainty is initially chosen so that it contains a
 minimizer of the modified function
 <p>
 <pre>
      f(x+stp*s) - f(x) - ftol*stp*(gradf(x)'s).
 </pre>
 If a step is obtained for which the modified function
 has a nonpositive function value and nonnegative derivative,
 then the interval of uncertainty is chosen so that it
 contains a minimizer of <code>f(x+stp*s)</code>.
 <p>
 The algorithm is designed to find a step which satisfies
 the sufficient decrease condition
 <p>
 <pre>
       f(x+stp*s) &lt;= f(X) + ftol*stp*(gradf(x)'s),
 </pre>
 and the curvature condition
 <p>
 <pre>
       abs(gradf(x+stp*s)'s)) &lt;= gtol*abs(gradf(x)'s).
 </pre>
 If <code>ftol</code> is less than <code>gtol</code> and if, for example,
 the function is bounded below, then there is always a step which
 satisfies both conditions. If no step can be found which satisfies both
 conditions, then the algorithm usually stops when rounding
 errors prevent further progress. In this case <code>stp</code> only
 satisfies the sufficient decrease condition.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>xold</code> - on input this contains the base point for the line search.</dd>
<dd><code>fold</code> - on input this contains the value of the objective function
             at <code>x</code>.</dd>
<dd><code>g</code> - on input this contains the gradient of the objective function
          at <code>x</code>.</dd>
<dd><code>p</code> - the search direction.</dd>
<dd><code>x</code> - on output, it contains <code>xold + alam*p</code>.</dd>
<dd><code>stpmax</code> - specify upper bound for the step in the line search so that
          we do not try to evaluate the function in regions where it is
          undefined or subject to overflow.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the new function value.</dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../index-all.html">Index</a></li>
<li><a href="../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../smile/math/AbstractDifferentiableMultivariateFunction.html" title="class in smile.math"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../smile/math/Complex.html" title="class in smile.math"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../index.html?smile/math/BFGS.html" target="_top">Frames</a></li>
<li><a href="BFGS.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small><script src="../../../../js/google-analytics.js" type="text/javascript"></script></small></p>
</body>
</html>
